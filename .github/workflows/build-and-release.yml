name: Build and Release
inputs:
tag:
description: 'Release tag (e.g. v1.0.0)'
required: true

jobs:
build-win:
runs-on: windows-latest
steps:
- uses: actions/checkout@v4
- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: '3.11'
- name: Install dependencies
run: |
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install pyinstaller
- name: Build exe (PyInstaller)
run: |
pyinstaller --clean --onefile --name ai-sphere app/gui_pyqt.py
- name: Upload artifact
uses: actions/upload-artifact@v4
with:
name: ai-sphere-windows
path: dist/ai-sphere.exe

build-linux:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v4
- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: '3.11'
- name: Install deps & build
run: |
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install pyinstaller
pyinstaller --clean --onefile --name ai-sphere app/gui_pyqt.py
- name: Upload artifact
uses: actions/upload-artifact@v4
with:
name: ai-sphere-linux
path: dist/ai-sphere

publish:
needs: [build-win, build-linux]
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v4
- name: Download Windows artifact
uses: actions/download-artifact@v4
with:
name: ai-sphere-windows
- name: Download Linux artifact
uses: actions/download-artifact@v4
with:
name: ai-sphere-linux
- name: Create Release
id: create_release
uses: softprops/action-gh-release@v1
with:
tag_name: ${{ github.event.inputs.tag }}
env:
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
- name: Upload assets to Release
uses: actions/upload-release-asset@v1
with:
upload_url: ${{ steps.create_release.outputs.upload_url }}
asset_path: ./dist/ai-sphere.exe
asset_name: ai-sphere-windows-${{ github.event.inputs.tag }}.exe
asset_content_type: application/octet-stream
